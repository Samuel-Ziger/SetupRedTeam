# ğŸ”’ Scripts de Reteste de SeguranÃ§a

Este diretÃ³rio contÃ©m scripts automatizados para reteste de vulnerabilidades identificadas durante os pentests realizados.

## ğŸ“‹ Ãndice

- [VisÃ£o Geral](#visÃ£o-geral)
- [Scripts DisponÃ­veis](#scripts-disponÃ­veis)
- [Como Usar](#como-usar)
- [Requisitos](#requisitos)
- [Estrutura dos RelatÃ³rios](#estrutura-dos-relatÃ³rios)

---

## ğŸ¯ VisÃ£o Geral

Cada script foi criado para validar as correÃ§Ãµes das vulnerabilidades especÃ­ficas encontradas em cada alvo durante o pentest inicial. Os scripts geram relatÃ³rios detalhados com indicadores coloridos de status.

### Legenda de Cores nos Scripts:

- ğŸ”´ **Vermelho**: Vulnerabilidade CRÃTICA/ALTA ainda presente
- ğŸŸ¡ **Amarelo**: Vulnerabilidade MÃ‰DIA ou atenÃ§Ã£o necessÃ¡ria
- ğŸŸ¢ **Verde**: ProteÃ§Ã£o implementada ou vulnerabilidade corrigida

---

## ğŸ“ Scripts DisponÃ­veis

### 1. `reteste_adivisao.sh` - adivisao.com.br

**Vulnerabilidades testadas:**

1. â— **ALTA**: ExposiÃ§Ã£o de Tokens/Chaves no Front-end
2. â— **ALTA**: EnumeraÃ§Ã£o de UsuÃ¡rios via Elasticsearch
3. â— **ALTAâ†’MÃ‰DIA**: CORS Inconsistente/Permissivo
4. â— **ALTAâ†’MÃ‰DIA**: Cookie de SessÃ£o sem HttpOnly
5. ğŸ”¸ **MÃ‰DIA**: Endpoints Internos do Elasticsearch Expostos
6. ğŸ”¸ **MÃ‰DIA**: CSP Apenas em Report-Only
7. ğŸ”¸ **MÃ‰DIA**: Rate Limiting Parcial
8. ğŸ”¹ **BAIXAâ†’MÃ‰DIA**: ExposiÃ§Ã£o de Infra e Headers SensÃ­veis
9. â— **CRÃTICA**: Endpoint /fileupload acessÃ­vel
10. ğŸ”¸ **MÃ‰DIA**: Portas Administrativas Expostas

**Comando:**
```bash
chmod +x reteste_adivisao.sh
./reteste_adivisao.sh
```

---

### 2. `reteste_divisaodeelite.sh` - divisaodeelite.com.br

**Vulnerabilidades testadas:**

1. â— **ALTA**: Token bubble_plp_token exposto no window
2. â— **ALTA**: Endpoint /version-test/api/1.1/init/data sem autenticaÃ§Ã£o
3. ğŸ”´ **CRÃTICA**: Plugin enviando dados para railway.app
4. â— **ALTA**: Cookies sem HttpOnly, Secure, SameSite
5. â— **ALTA**: Scripts de terceiros sem SRI
6. â— **ALTA**: Service Worker registrÃ¡vel
7. â— **ALTA**: AusÃªncia de CSP
8. ğŸ”¸ **MÃ‰DIA**: CSP Permissivo - Form Hijacking
9. ğŸ”¸ **MÃ‰DIA**: Proxies JS - prototype pollution
10. ğŸ”¸ **MÃ‰DIA**: Fingerprinting Bubble.io
11. ğŸ”¹ **INFO**: Portas alternativas Cloudflare

**Comando:**
```bash
chmod +x reteste_divisaodeelite.sh
./reteste_divisaodeelite.sh
```

---

### 3. `reteste_acheumveterano.sh` - acheumveterano.com.br / app.acheumveterano.com.br

**Vulnerabilidades testadas:**

1. ğŸ”´ **CRÃTICA**: OpenSSH 10.0p2 (CVE-2025-61985, CVE-2025-61984)
2. â— **ALTA**: Arquivos de log expostos (wp-app.log)
3. â— **ALTA**: WordPress - endpoints sensÃ­veis
4. ğŸ”¸ **MÃ‰DIA**: AusÃªncia de headers anti-clickjacking
5. ğŸ”¸ **MÃ‰DIA**: CompressÃ£o HTTP - risco BREACH
6. ğŸ”¹ **INFO**: VerificaÃ§Ã£o TLS/SSL
7. ğŸ”¸ **MÃ‰DIA**: Cookies sem proteÃ§Ã£o
8. ğŸ”¸ **MÃ‰DIA**: DiretÃ³rios sensÃ­veis
9. ğŸ”¹ **INFO**: VerificaÃ§Ã£o robots.txt

**Comando:**
```bash
chmod +x reteste_acheumveterano.sh
./reteste_acheumveterano.sh
```

**ObservaÃ§Ãµes especiais:**
- Testa redirecionamento para app.acheumveterano.com.br
- Verifica SSH na porta 22
- Testa WordPress especÃ­fico

---

### 4. `reteste_idivis.sh` - idivis.ao / 31.97.27.219

**Vulnerabilidades testadas:**

1. ğŸ”´ **CRÃTICA**: Porta 3000 (Next.js dev) exposta
2. ğŸ”´ **CRÃTICA**: Arquivos sensÃ­veis (.mysql_history, .ssh, .bash_history)
3. ğŸ”´ **CRÃTICA**: DiretÃ³rios de backup (_backup, _db_backups)
4. â— **ALTA**: SSH acessÃ­vel (31.97.27.129:22)
5. ğŸ”¸ **MÃ‰DIA**: AusÃªncia de headers de seguranÃ§a
6. ğŸ”¹ **INFO**: Porta 3030 filtrada
7. ğŸ”¸ **MÃ‰DIA**: Endpoints administrativos
8. ğŸ”¸ **MÃ‰DIA**: Fingerprinting Next.js
9. ğŸ”¹ **INFO**: Scan de portas

**Comando:**
```bash
chmod +x reteste_idivis.sh
./reteste_idivis.sh
```

**ObservaÃ§Ãµes especiais:**
- Testa dois IPs: 31.97.27.219 e 31.97.27.129
- Foco em arquivos sensÃ­veis e backups
- Verifica proteÃ§Ã£o Cloudflare

---

### 5. `reteste_planodechamadas.sh` - planodechamadas.com.br / lp.planodechamadas.com.br

**Vulnerabilidades testadas:**

1. ğŸ”´ **CRÃTICA**: ExposiÃ§Ã£o direta do IP (bypass CDN/WAF)
2. ğŸ”´ **CRÃTICA**: Next.js sem seguranÃ§a - SSRF, LFI/RFI
3. â— **ALTA**: Headers incomuns revelando tecnologias
4. â— **ALTA**: AusÃªncia de HSTS
5. â— **ALTA**: AusÃªncia de X-Frame-Options
6. â— **ALTA**: AusÃªncia de CSP
7. ğŸ”¹ **INFO**: ConfiguraÃ§Ã£o TLS/SSL (validar boas prÃ¡ticas)
8. ğŸ”¸ **MÃ‰DIA**: APIs Next.js expostas
9. ğŸ”¸ **MÃ‰DIA**: CORS
10. ğŸ”¸ **MÃ‰DIA**: Rate Limiting

**Comando:**
```bash
chmod +x reteste_planodechamadas.sh
./reteste_planodechamadas.sh
```

**ObservaÃ§Ãµes especiais:**
- Testa tanto domÃ­nio principal quanto LP
- VerificaÃ§Ã£o completa de TLS/SSL
- Teste de bypass de CDN

---

### 6. `reteste_ngrok.sh` - 0fc5d3bbe18c.ngrok-free.app

**Vulnerabilidades testadas:**

1. ğŸ”¸ **MÃ‰DIA**: AusÃªncia de X-Frame-Options
2. ğŸ”¸ **MÃ‰DIA**: AusÃªncia de X-Content-Type-Options
3. ğŸ”¸ **MÃ‰DIA**: AusÃªncia de headers de seguranÃ§a gerais
4. ğŸ”¹ **INFO**: EnumeraÃ§Ã£o de diretÃ³rios
5. ğŸ”¹ **INFO**: APIs expostas
6. ğŸ”¸ **MÃ‰DIA**: CORS
7. ğŸ”¸ **MÃ‰DIA**: Cookies sem proteÃ§Ã£o
8. ğŸ”¹ **INFO**: Arquivos sensÃ­veis

**Comando:**
```bash
chmod +x reteste_ngrok.sh
./reteste_ngrok.sh
```

**âš ï¸ ATENÃ‡ÃƒO**: URL temporÃ¡ria do ngrok que pode expirar. O script verifica disponibilidade antes de executar os testes.

---

## ğŸš€ Como Usar

### PreparaÃ§Ã£o:

1. **Navegar atÃ© o diretÃ³rio:**
   ```bash
   cd /c/Users/Ziger/Documents/Pentest/retestesh
   ```

2. **Tornar os scripts executÃ¡veis:**
   ```bash
   chmod +x *.sh
   ```

### ExecuÃ§Ã£o Individual:

```bash
# Exemplo: testar adivisao.com.br
./reteste_adivisao.sh
```

### ExecuÃ§Ã£o em Lote:

```bash
# Executar todos os scripts
for script in reteste_*.sh; do
    echo "========================================="
    echo "Executando: $script"
    echo "========================================="
    ./$script
    echo ""
done
```

---

## ğŸ“¦ Requisitos

### Ferramentas NecessÃ¡rias:

- `curl` - requisiÃ§Ãµes HTTP
- `grep` - busca de padrÃµes
- `openssl` - verificaÃ§Ã£o de certificados e TLS
- `nc` (netcat) - teste de portas
- `bash` - interpretador de shell
- `timeout` - controle de tempo de execuÃ§Ã£o

### Instalar no Linux (Debian/Ubuntu):

```bash
sudo apt update
sudo apt install -y curl grep openssl netcat-openbsd coreutils bash
```

### Instalar no Windows (WSL/Git Bash):

A maioria dessas ferramentas jÃ¡ vem instalada com Git Bash ou WSL.

---

## ğŸ“Š Estrutura dos RelatÃ³rios

Cada script gera um diretÃ³rio com timestamp contendo os resultados:

```
reteste_[alvo]_YYYYMMDD_HHMMSS/
â”œâ”€â”€ 01_[teste].txt
â”œâ”€â”€ 02_[teste].txt
â”œâ”€â”€ 03_[teste].txt
â””â”€â”€ ...
```

### Exemplo:

```
reteste_adivisao_20251128_143052/
â”œâ”€â”€ 01_tokens_expostos.txt
â”œâ”€â”€ 02_elasticsearch_enum.txt
â”œâ”€â”€ 03_cors_test.txt
â”œâ”€â”€ 04_cookies.txt
â”œâ”€â”€ 05_elasticsearch_endpoints.txt
â”œâ”€â”€ 06_security_headers.txt
â”œâ”€â”€ 07_rate_limiting.txt
â”œâ”€â”€ 08_infra_headers.txt
â”œâ”€â”€ 09_fileupload.txt
â””â”€â”€ 10_admin_ports.txt
```

---

## ğŸ” InterpretaÃ§Ã£o dos Resultados

### CÃ³digos HTTP Comuns:

- **200**: Sucesso - recurso acessÃ­vel
- **301/302/307/308**: Redirecionamento
- **401**: NÃ£o autorizado (proteÃ§Ã£o presente)
- **403**: Proibido (proteÃ§Ã£o presente)
- **404**: NÃ£o encontrado (esperado para recursos sensÃ­veis)
- **429**: Too Many Requests (rate limiting ativo)
- **500/502/503**: Erro no servidor

### Indicadores de SeguranÃ§a:

âœ… **BOM**:
- Headers de seguranÃ§a presentes (HSTS, CSP, X-Frame-Options)
- Recursos sensÃ­veis retornam 404/403
- Rate limiting ativo (429)
- Cookies com HttpOnly, Secure, SameSite
- Protocolos TLS modernos (1.2, 1.3)

âŒ **RUIM**:
- Tokens/chaves expostos no cÃ³digo
- Arquivos sensÃ­veis acessÃ­veis (200)
- Headers ausentes
- Cookies sem proteÃ§Ã£o
- Protocolos TLS obsoletos (1.0, 1.1)
- CORS permissivo (*)

---

## ğŸ“ Notas Importantes

1. **AutorizaÃ§Ã£o**: Execute apenas em alvos autorizados
2. **Rate Limiting**: Os scripts respeitam delays entre requisiÃ§Ãµes
3. **Logs**: Todos os testes sÃ£o nÃ£o-destrutivos (somente leitura)
4. **Privacidade**: NÃ£o compartilhe os relatÃ³rios - podem conter dados sensÃ­veis
5. **AtualizaÃ§Ã£o**: Re-execute os scripts apÃ³s aplicar correÃ§Ãµes

---

## ğŸ”„ Fluxo de Trabalho Recomendado

1. **Pentest Inicial** â†’ IdentificaÃ§Ã£o de vulnerabilidades
2. **RelatÃ³rio de Vulnerabilidades** â†’ DocumentaÃ§Ã£o
3. **Plano de CorreÃ§Ã£o** â†’ PriorizaÃ§Ã£o
4. **AplicaÃ§Ã£o de CorreÃ§Ãµes** â†’ RemediaÃ§Ã£o
5. **Reteste** â†’ ValidaÃ§Ã£o com estes scripts âœ…
6. **RelatÃ³rio de Reteste** â†’ ConfirmaÃ§Ã£o

---

## ğŸ“ Suporte

**Autor**: Samuel Ziger  
**Data de CriaÃ§Ã£o**: 28/11/2025  
**VersÃ£o**: 1.0

---

## ğŸ“„ LicenÃ§a

Scripts criados para uso interno em atividades de pentest autorizadas.

**âš ï¸ USO RESPONSÃVEL**: Estes scripts devem ser usados apenas em sistemas para os quais vocÃª tem autorizaÃ§Ã£o explÃ­cita para testar.

---

## ğŸ¯ Checklist de Reteste

Use esta checklist para acompanhar o progresso dos retestes:

- [ ] **adivisao.com.br** - Tokens, Elasticsearch, CORS, Cookies
- [ ] **divisaodeelite.com.br** - Bubble token, Plugins, CSP
- [ ] **acheumveterano.com.br** - SSH, WordPress, Logs
- [ ] **idivis.ao (31.97.27.219)** - Porta 3000, Backups, SSH
- [ ] **planodechamadas.com.br** - Headers, TLS, Next.js
- [ ] **ngrok URL** - Headers, DiretÃ³rios, APIs

---

**Ãšltima atualizaÃ§Ã£o**: 28/11/2025
